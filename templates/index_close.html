{% extends "base.html" %}

{% block title %}Добро пожаловать в мир онлайн-турниров! - Лига Знатоков{% endblock %}

{% block description %}Международная платформа, где учеба превращается в увлекательное приключение для учащихся 1–11 классов из Беларуси и России. Онлайн турниры по математике, физике, химии и другим предметам.{% endblock %}

{% block keywords %}онлайн турниры, школьные турниры, математические турниры, физика турниры, химия турниры, лига знатоков, онлайн соревнования, турниры для школьников, турниры 1-11 класс, международная платформа{% endblock %}

{% block og_title %}Добро пожаловать в мир онлайн-турниров!{% endblock %}

{% block og_description %}Международная платформа, где учеба превращается в увлекательное приключение для учащихся 1–11 классов из Беларуси и России{% endblock %}

{% block twitter_title %}Добро пожаловать в мир онлайн-турниров!{% endblock %}

{% block twitter_description %}Международная платформа, где учеба превращается в увлекательное приключение для учащихся 1–11 классов из Беларуси и России{% endblock %}

{% block styles %}
<style>
    .season-closed-hero-alt {
        background: radial-gradient(1200px 400px at 10% -10%, rgba(255, 215, 0, 0.25), transparent),
                    radial-gradient(1000px 380px at 90% 10%, rgba(255, 140, 0, 0.20), transparent),
                    linear-gradient(180deg, #2c2c32 0%, #1f1f24 100%);
        color: #fff;
        padding: 3rem 0;
        position: relative;
        overflow: hidden;
    }
    .glass-card {
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: var(--border-radius);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
        backdrop-filter: blur(10px);
        color: #fff;
    }
    .hero-badge {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.35rem 0.75rem;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.08);
        border: 1px solid rgba(255, 255, 255, 0.15);
        font-weight: 600;
        color: #fff;
    }
    .hero-title {
        font-weight: 800;
        letter-spacing: 0.2px;
        margin-bottom: 0.5rem;
        color: #fff;
    }
    .hero-lead { color: #e8e8ea; }
    .tile-card {
        border-radius: var(--border-radius);
        border: 1px solid rgba(0,0,0,0.06);
        transition: var(--transition);
    }
     /* Немного увеличиваем минимальную высоту геро-секции */
     .season-closed-hero-alt { min-height: 65vh; }
     @media (max-width: 576px) { .season-closed-hero-alt { min-height: 60vh; } }
    .tile-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--box-shadow-hover);
    }
    .tile-icon {
        font-size: 1.6rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px; height: 40px;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        color: var(--text-color);
    }
    .alt-accordion .accordion-button:not(.collapsed) {
        background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        color: var(--text-color);
        box-shadow: none;
    }
    .alt-accordion .accordion-item {
        border-radius: var(--border-radius) !important;
        overflow: hidden;
        border: 1px solid var(--border-color);
    }
    .alt-accordion .accordion-button { border: none; }
    .alt-accordion .accordion-body { color: var(--text-light); }
    .quick-actions .btn { min-width: 160px; }
    @media (max-width: 576px) { .quick-actions .btn { width: 100%; min-width: unset; } }
    /* Кнопки в блоке "Что дальше?": на мобильных в столбик */
    @media (max-width: 576px) {
        .cta-actions { flex-direction: column !important; align-items: stretch !important; }
        .cta-actions .btn { width: 100%; }
    }
     /* Убираем белую полосу между секцией и футером */
     main { padding-bottom: 0 !important; }
     .season-closed-hero-alt { margin-bottom: 0; }
     /* Градиент футера вынесен в глобальные стили */
    </style>
{% endblock %}

{% block content %}
{% set show_partners = true %}
<!-- Модальное окно приветствия для новых пользователей -->
<div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="welcomeModalLabel">
                    <i class="fas fa-star me-2"></i>
                    Добро пожаловать в Лигу Знатоков!
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="welcome-step mb-4 registration-step" onclick="window.location.href='{{ url_for('register') }}'" style="cursor: pointer; transition: all 0.3s ease;">
                            <div class="step-icon mb-3">
                                <i class="fas fa-user-plus fa-2x text-primary"></i>
                            </div>
                            <h6 class="fw-bold">1. Регистрация</h6>
                            <p class="text-muted small">Зарегистрируйтесь и войдите в личный кабинет</p>
                        </div>
                        
                        <div class="welcome-step mb-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-coins fa-2x text-warning"></i>
                            </div>
                            <h6 class="fw-bold">2. Жетоны</h6>
                            <p class="text-muted small">Купите жетоны для участия в турнирах</p>
                        </div>
                        
                        <div class="welcome-step mb-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-trophy fa-2x text-info"></i>
                            </div>
                            <h6 class="fw-bold">3. Участвуйте в турнирах</h6>
                            <p class="text-muted small">Дождитесь начала турнира. Информация о ближайшем турнире доступна на главной странице</p>
                        </div>
                        
                        <div class="welcome-step mb-4">
                            <div class="step-icon mb-3">
                                <i class="fas fa-medal fa-2x text-success"></i>
                            </div>
                            <h6 class="fw-bold">4. Зарабатывайте баллы</h6>
                            <p class="text-muted small">Получайте баллы за правильные ответы и поднимайтесь в рейтинге. В конце сезона обменивайте баллы на призы</p>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="welcome-features">
                            <h6 class="fw-bold mb-3 text-dark">Преимущества платформы:</h6>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Увлекательные математические задачи
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Соревнования с участниками вашего возраста
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Система рейтинга и достижений
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Возможность отслеживать свой прогресс
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Обмен баллов на призы в конце сезона
                                </li>
                                <li class="mb-2">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    Получай индивидуальные рекомендации по итогам турнира
                                </li>
                            </ul>
                            
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-info-circle me-2"></i>
                                <strong>Готовы начать?</strong> Нажмите кнопку "Зарегистрироваться" ниже!
                            </div>
                            
                            <div class="text-center mt-4">
                                <a href="{{ url_for('register') }}" class="btn btn-primary w-100">
                                    <i class="fas fa-user-plus me-1"></i>
                                    Зарегистрироваться
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<section class="season-closed-hero-alt w-100">
    <div class="container-fluid px-0">
        <div class="px-3 px-md-4 px-lg-5">
            <div class="row align-items-center g-4">
            <div class="col-lg-7">
                <div class="hero-badge mb-3">
                    <i class="bi bi-calendar-x-fill"></i>
                    Сезон турниров завершён
                </div>
                <h1 class="hero-title">Готовим новый сезон — будет ещё интереснее!</h1>
                <p class="hero-lead mb-4">{{ message|safe }}</p>
                <div class="quick-actions d-flex flex-wrap gap-2">
                    <a href="{{ url_for('news') }}" class="btn btn-primary">
                        <i class="bi bi-newspaper me-1"></i>Новости
                    </a>
                    <a href="{{ url_for('rating') }}" class="btn btn-primary">
                        <i class="bi bi-list-ol me-1"></i>Рейтинг
                    </a>
                    <a href="{{ url_for('how_to_participate') }}" class="btn btn-primary">
                        <i class="bi bi-question-circle me-1"></i>Как участвовать
                    </a>
                </div>
            </div>
            <div class="col-lg-5">
                <div class="glass-card p-4 h-100">
                    <h5 class="mb-3 text-white">
                        <i class="bi bi-lightning-charge-fill text-warning me-2"></i>
                        Что дальше?
                    </h5>
                    <ul class="list-unstyled mb-0">
                        <li class="mb-2">
                            <i class="bi bi-check2-circle text-success me-2"></i>
                            Ознакомьтесь с итогами сезона
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check2-circle text-success me-2"></i>
                            Обменивай заработанные баллы на призы в Лавке призов
                        </li>
                        <li class="mb-2">
                            <i class="bi bi-check2-circle text-success me-2"></i>
                            Следите за анонсами в разделе «Новости»
                        </li>
                    </ul>
                    <div class="mt-3 d-flex flex-wrap gap-2 cta-actions">
                        <a href="{{ url_for('shop') if current_user.is_authenticated and not isinstance(current_user, Teacher) else url_for('shop_preview') }}" class="btn btn-warning text-dark">
                            <i class="bi bi-gift-fill me-1"></i>Лавка призов
                        </a>
                        {% if not current_user.is_authenticated %}
                        <a href="{{ url_for('login') }}" class="btn btn-outline-light">
                            <i class="bi bi-box-arrow-in-right me-1"></i>Войти
                        </a>
                        <a href="javascript:void(0)" onclick="showRegistrationModal()" class="btn btn-outline-light">
                            <i class="bi bi-person-plus-fill me-1"></i>Регистрация
                        </a>
                        {% else %}
                        <a href="{{ url_for('profile') }}" class="btn btn-outline-light">
                            <i class="bi bi-person-circle me-1"></i>Личный кабинет
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>
</section>

<!-- CSS стили для активного блока регистрации -->
<style>
.registration-step {
    border: 2px solid transparent;
    border-radius: 10px;
    padding: 15px;
    transition: all 0.3s ease;
}

.registration-step:hover {
    border-color: #007bff;
    background-color: rgba(0, 123, 255, 0.05);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 123, 255, 0.15);
}

.registration-step:active {
    transform: translateY(0);
    box-shadow: 0 2px 6px rgba(0, 123, 255, 0.2);
}

.registration-step .step-icon {
    transition: transform 0.3s ease;
}

.registration-step:hover .step-icon {
    transform: scale(1.1);
}

.registration-step:hover .step-icon i {
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}
</style>

<!-- JavaScript для модального окна приветствия -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Проверяем, авторизован ли пользователь
    const isAuthenticated = document.body.getAttribute('data-user-authenticated') === 'true';
    
    // Если пользователь не авторизован и еще не видел приветствие
    if (!isAuthenticated && !getCookie('welcomeModalShown')) {
        // Показываем модальное окно через 10 секунд после загрузки страницы
        setTimeout(function() {
            const welcomeModal = new bootstrap.Modal(document.getElementById('welcomeModal'));
            welcomeModal.show();
        }, 10000);
    }
    
    // Функция для установки куки
    function setCookie(name, value, days) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = name + '=' + value + ';expires=' + expires.toUTCString() + ';path=/';
    }
    
    // Функция для получения куки
    function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) == ' ') c = c.substring(1, c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
    }
    
    // Обработчик для кнопки "Зарегистрироваться" в модальном окне
    const registerBtn = document.querySelector('#welcomeModal .btn-primary');
    if (registerBtn) {
        registerBtn.addEventListener('click', function() {
            // Закрываем модальное окно
            const welcomeModal = bootstrap.Modal.getInstance(document.getElementById('welcomeModal'));
            if (welcomeModal) {
                welcomeModal.hide();
            }
        });
    }
    
    // Обработчик для блока регистрации
    const registrationStep = document.querySelector('.registration-step');
    if (registrationStep) {
        registrationStep.addEventListener('click', function() {
            // Закрываем модальное окно перед переходом
            const welcomeModal = bootstrap.Modal.getInstance(document.getElementById('welcomeModal'));
            if (welcomeModal) {
                welcomeModal.hide();
            }
        });
    }
});
</script>
{% endblock %}